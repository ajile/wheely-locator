<html>
<head>
    <meta charset="utf-8">
    <title>Wheely test task</title>
    <link rel="stylesheet" href="/public/stylesheet/base.css">

    <!--
        Секция для подгрузки файлов из сторонних CDN.
        Такая реализация нужна для того, чтобы ускорить загрузку файлов пользователем за счет того, что запрашиваемые файлы могут уже находиться в кэше браузера пользователя, либо за счет того, что cloudflare.com имеет обширное покрытие серверами по всему миру, в случае если файл отсутствует в кэше. Также такой подход повышат отказоустойчивость за счет наличия нескольких источников.
    -->

    <!-- jQuery -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/public/javascript/vendor/jquery.min.js" %}"><\/script>')</script>

    <!-- jQuery Cookie -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script>window.jQuery || document.write('<script src="/public/javascript/vendor/jquery.min.js" %}"><\/script>')</script>

    <!-- Underscore -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
    <script>window._ || document.write('<script src="/public/javascript/vendor/underscore-min.js" %}"><\/script>')</script>

    <!-- Handlebars (need for Ember) -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.0.0/handlebars.min.js"></script>
    <script>window.Handlebars || document.write('<script src="/public/javascript/vendor/handlebars.min.js" %}"><\/script>')</script>

    <!-- Ember -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/ember.js/1.7.0/ember.min.js"></script>
    <script>window.Ember || document.write('<script src="/public/javascript/vendor/ember.min.js" %}"><\/script>')</script>

    <!-- Ember-data -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/ember-data.js/1.0.0-beta.10/ember-data.min.js"></script>
    <script>window.Ember || document.write('<script src="/public/javascript/vendor/ember-data.min.js" %}"><\/script>')</script>

    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=true"></script>

    <script type="text/javascript">
      function initialize() {
        var mapOptions = {
          center: new google.maps.LatLng(-34.397, 150.644),
          zoom: 8,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("maps_canvas"),
            mapOptions);
      }
    </script>

    <script type="text/javascript" src="/public/javascript/lib.js"></script>
</head>
<body>

    <script type="text/x-handlebars">
        <div class="app-wrapper">
        {{outlet}}
        </div>
    </script>


    <script type="text/x-handlebars" id="components/google-maps">
        <div class="map-canvas"></div>
    </script>


    <script type="text/x-handlebars" data-template-name="login">
        <header id="header">
            <h1>Авторизация</h1>
        </header>

        {{#if isAuthenticated}}
            <section id="login">Вы авторизованы</section>
            <footer id="footer">
                {{#link-to 'maps'}}<button>Перейти к карте</button>{{/link-to}}
                <button {{action logout}}>Выйти</button>
            </footer>
        {{else}}

        <form class="form-block" {{action processForm on="submit"}}>
            <section id="login">
                {{input value=username type="text" placeholder="Username" autofocus=true}}
                {{input value=password type="password" placeholder="Password"}}
                {{#if errorMessage}}
                    <div class="message message-error">{{errorMessage}}</div>
                {{/if}}
            </section>

            <footer id="footer">
                {{input class="btn" type="submit" value="Войти"}}
            </footer>
        </form>
        {{/if}}
    </script>

    <script type="text/x-handlebars" data-template-name="maps">
        <header id="header">
            <h1>Карта</h1>
        </header>

        <section id="maps_canvas">
            {{google-maps latitude="40.7142700" longitude="-74.0059700" markers=markers}}
        </section>

        <footer id="footer">
            {{#if isAuthenticated}}
                <button id="connection-switcher" {{action logout}}>Отключиться</button>
            {{/if}}
        </footer>
    </script>

    <!-- ... наше приложение подключается здесь НАЧ ... -->
    <script type="text/javascript" src="/public/javascript/application.js"></script>
    <script type="text/javascript" src="/public/javascript/session.js"></script>
    <script type="text/javascript" src="/public/javascript/connection.js"></script>
    <script type="text/javascript" src="/public/javascript/adapter.js"></script>
    <script type="text/javascript" src="/public/javascript/router.js"></script>
    <script type="text/javascript" src="/public/javascript/controller.js"></script>
    <script type="text/javascript" src="/public/javascript/component.js"></script>
    <script type="text/javascript" src="/public/javascript/models/user.js"></script>
    <!-- ... наше приложение подключается здесь КОН ... -->
</body>
</html>