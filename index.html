<html>
<head>
    <meta charset="utf-8">
    <title>Wheely test task</title>

    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;"/>

    <link rel="stylesheet" href="/public/stylesheet/base.css">

    <!--
        Секция для подгрузки файлов из сторонних CDN.
        Такая реализация нужна для того, чтобы ускорить загрузку файлов пользователем за счет того,
        что запрашиваемые файлы могут уже находиться в кэше браузера пользователя, либо за
        счет того, что cloudflare.com имеет обширное покрытие серверами по всему миру, в случае
        если файл отсутствует в кэше. Также такой подход повышат отказоустойчивость за счет наличия
        нескольких источников.
    -->

    <!-- jQuery -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>window.jQuery || document.writeln('<script src="/public/javascript/vendor/jquery.min.js"><\/script>')</script>

    <!-- jQuery Cookie -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script>window.jQuery.cookie || document.writeln('<script src="/public/javascript/vendor/jquery.cookie.min.js"><\/script>')</script>

    <!-- Underscore -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
    <script>window._ || document.writeln('<script src="/public/javascript/vendor/underscore-min.js"><\/script>')</script>

    <!-- Handlebars (need for Ember) -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.0.0/handlebars.min.js"></script>
    <script>window.Handlebars || document.writeln('<script src="/public/javascript/vendor/handlebars.min.js"><\/script>')</script>

    <!-- Ember -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/ember.js/1.7.0/ember.min.js"></script>
    <script>window.Ember || document.writeln('<script src="/public/javascript/vendor/ember.min.js"><\/script>')</script>

    <!-- Ember-data (к сожалению Ember-data поддерживает только 1.0.0 версию Ember, но мы все равно будем его юзать) -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/ember-data.js/1.0.0-beta.10/ember-data.min.js"></script>
    <script>window.DS || document.writeln('<script src="/public/javascript/vendor/ember-data.min.js"><\/script>')</script>

    <!-- javascript-mobile-desktop-geolocation -->
    <!-- <script type="text/javascript" src="/public/javascript/vendor/geoPosition.js"></script> -->

    <!-- Google карты -->
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=true"></script>

    <!-- Глобальные функции -->
    <!-- <script type="text/javascript" src="/public/javascript/lib.js"></script> -->

</head>
<body>

    <script type="text/x-handlebars">
        <div class="app-wrapper">
        {{outlet}}
        </div>
    </script>


    <script type="text/x-handlebars" id="components/google-maps">
        <div class="map-canvas"></div>
    </script>


    <script type="text/x-handlebars" data-template-name="login">
        <header id="header">
            <h1>Авторизация</h1>
        </header>

        {{#if isAuthenticated}}
            <section id="login">Вы авторизованы</section>
            <footer id="footer">
                {{#link-to 'maps'}}<button class="green">Перейти к карте</button>{{/link-to}}
                <button {{action logout}}>Выйти</button>
            </footer>
        {{else}}

        <form class="form-block" {{action processForm on="submit"}}>
            <section class="login">
                <div class="field">{{input value=username type="text" placeholder="Username" autofocus=true}}</div>
                <div class="field">{{input value=password type="password" placeholder="Password"}}</div>
                {{#if errorMessage}}
                    <div class="message message-error">{{errorMessage}}</div>
                {{/if}}
            </section>

            <footer id="footer">
                {{input class="btn" type="submit" value="Приконнектиться" class="green"}}
            </footer>
        </form>
        {{/if}}
    </script>

    <script type="text/x-handlebars" data-template-name="maps">
        <header id="header">
            <h1>Карта</h1>
        </header>

        <section class="maps">
            {{google-maps latitude="55.7500" longitude="37.6167" coords=coords}}
        </section>

        <footer id="footer">
            {{#if isAuthenticated}}
                <button id="connection-switcher" class="red" {{action logout}}>Отключиться</button>
            {{/if}}
        </footer>
    </script>

    <!-- ... наше приложение подключается здесь НАЧ ... -->
    <script type="text/javascript" src="/public/javascript/application.min.js"></script>

    <!-- <script type="text/javascript" src="/public/javascript/services/user.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/services/session.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/services/connection.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/services/adapter.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/services/geolocator.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/application.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/session.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/connection.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/adapter.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/geolocator.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/router.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/controller.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/component.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/models/geopoint.js"></script> -->
    <!-- <script type="text/javascript" src="/public/javascript/models/user.js"></script> -->
    <!-- ... наше приложение подключается здесь КОН ... -->
</body>
</html>